(function(){if(typeof Crypto=="undefined"||!Crypto.util){(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var f=window.Crypto={};var b=f.util={rotl:function(j,i){return(j<<i)|(j>>>(32-i))},rotr:function(j,i){return(j<<(32-i))|(j>>>i)},endian:function(k){if(k.constructor==Number){return b.rotl(k,8)&16711935|b.rotl(k,24)&4278255360}for(var j=0;j<k.length;j++){k[j]=b.endian(k[j])}return k},randomBytes:function(j){for(var i=[];j>0;j--){i.push(Math.floor(Math.random()*256))}return i},bytesToWords:function(k){for(var m=[],l=0,j=0;l<k.length;l++,j+=8){m[j>>>5]|=(k[l]&255)<<(24-j%32)}return m},wordsToBytes:function(k){for(var j=[],i=0;i<k.length*32;i+=8){j.push((k[i>>>5]>>>(24-i%32))&255)}return j},bytesToHex:function(j){for(var l=[],k=0;k<j.length;k++){l.push((j[k]>>>4).toString(16));l.push((j[k]&15).toString(16))}return l.join("")},hexToBytes:function(j){for(var i=[],k=0;k<j.length;k+=2){i.push(parseInt(j.substr(k,2),16))}return i},bytesToBase64:function(l){if(typeof btoa=="function"){return btoa(g.bytesToString(l))}for(var k=[],n=0;n<l.length;n+=3){var o=(l[n]<<16)|(l[n+1]<<8)|l[n+2];for(var m=0;m<4;m++){if(n*8+m*6<=l.length*8){k.push(e.charAt((o>>>6*(3-m))&63))}else{k.push("=")}}}return k.join("")},base64ToBytes:function(k){if(typeof atob=="function"){return g.stringToBytes(atob(k))}k=k.replace(/[^A-Z0-9+/]/ig,"");for(var j=[],l=0,m=0;l<k.length;m=++l%4){if(m==0){continue}j.push(((e.indexOf(k.charAt(l-1))&(Math.pow(2,-2*m+8)-1))<<(m*2))|(e.indexOf(k.charAt(l))>>>(6-m*2)))}return j}};var d=f.charenc={};var h=d.UTF8={stringToBytes:function(i){return g.stringToBytes(unescape(encodeURIComponent(i)))},bytesToString:function(i){return decodeURIComponent(escape(g.bytesToString(i)))}};var g=d.Binary={stringToBytes:function(l){for(var j=[],k=0;k<l.length;k++){j.push(l.charCodeAt(k)&255)}return j},bytesToString:function(j){for(var l=[],k=0;k<j.length;k++){l.push(String.fromCharCode(j[k]))}return l.join("")}}})()}(function(){var h=Crypto,b=h.util,d=h.charenc,g=d.UTF8,f=d.Binary;var e=h.SHA1=function(k,i){var j=b.wordsToBytes(e._sha1(k));return i&&i.asBytes?j:i&&i.asString?f.bytesToString(j):b.bytesToHex(j)};e._sha1=function(q){if(q.constructor==String){q=g.stringToBytes(q)}var y=b.bytesToWords(q),z=q.length*8,r=[],u=1732584193,s=-271733879,p=-1732584194,o=271733878,k=-1009589776;y[z>>5]|=128<<(24-z%32);y[((z+64>>>9)<<4)+15]=z;for(var B=0;B<y.length;B+=16){var G=u,F=s,E=p,D=o,C=k;for(var A=0;A<80;A++){if(A<16){r[A]=y[B+A]}else{var x=r[A-3]^r[A-8]^r[A-14]^r[A-16];r[A]=(x<<1)|(x>>>31)}var v=((u<<5)|(u>>>27))+k+(r[A]>>>0)+(A<20?(s&p|~s&o)+1518500249:A<40?(s^p^o)+1859775393:A<60?(s&p|s&o|p&o)-1894007588:(s^p^o)-899497514);k=o;o=p;p=(s<<30)|(s>>>2);s=u;u=v}u+=G;s+=F;p+=E;o+=D;k+=C}return[u,s,p,o,k]};e._blocksize=16;e._digestsize=20})();(function(){var g=Crypto,b=g.util,d=g.charenc,f=d.UTF8,e=d.Binary;g.HMAC=function(n,o,m,k){if(o.constructor==String){o=f.stringToBytes(o)}if(m.constructor==String){m=f.stringToBytes(m)}if(m.length>n._blocksize*4){m=n(m,{asBytes:true})}var j=m.slice(0),p=m.slice(0);for(var l=0;l<n._blocksize*4;l++){j[l]^=92;p[l]^=54}var h=n(j.concat(n(p.concat(o),{asBytes:true})),{asBytes:true});return k&&k.asBytes?h:k&&k.asString?e.bytesToString(h):b.bytesToHex(h)}})();(function(){var g=Crypto,b=g.util,d=g.charenc,f=d.UTF8,e=d.Binary;g.PBKDF2=function(s,q,h,w){if(s.constructor==String){s=f.stringToBytes(s)}if(q.constructor==String){q=f.stringToBytes(q)}var v=w&&w.hasher||g.SHA1,m=w&&w.iterations||1;function r(i,j){return g.HMAC(v,j,i,{asBytes:true})}var l=[],k=1;while(l.length<h){var n=r(s,q.concat(b.wordsToBytes([k])));for(var t=n,p=1;p<m;p++){t=r(s,t);for(var o=0;o<n.length;o++){n[o]^=t[o]}}l=l.concat(n);k++}l.length=h;return w&&w.asBytes?l:w&&w.asString?e.bytesToString(l):b.bytesToHex(l)}})();
/*
 * Crypto-JS contribution from Simon Greatrix
 */
(function(b){var m=b.pad={};function e(s,u){var v=s._blocksize*4;var t=v-u.length%v;return t}var f=function(t){var u=t.pop();for(var s=1;s<u;s++){t.pop()}};m.NoPadding={pad:function(s,t){},unpad:function(s){}};m.ZeroPadding={pad:function(s,u){var v=s._blocksize*4;var t=u.length%v;if(t!=0){for(t=v-t;t>0;t--){u.push(0)}}},unpad:function(s){}};m.iso7816={pad:function(s,u){var t=e(s,u);u.push(128);for(;t>1;t--){u.push(0)}},unpad:function(s){while(s.pop()!=128){}}};m.ansix923={pad:function(s,v){var u=e(s,v);for(var t=1;t<u;t++){v.push(0)}v.push(u)},unpad:f};m.iso10126={pad:function(s,v){var u=e(s,v);for(var t=1;t<u;t++){v.push(Math.floor(Math.random()*256))}v.push(u)},unpad:f};m.pkcs7={pad:function(s,v){var u=e(s,v);for(var t=0;t<u;t++){v.push(u)}},unpad:f};var l=b.mode={};var q=l.Mode=function(s){if(s){this._padding=s}};q.prototype={encrypt:function(t,s,u){this._padding.pad(t,s);this._doEncrypt(t,s,u)},decrypt:function(t,s,u){this._doDecrypt(t,s,u);this._padding.unpad(s)},_padding:m.iso7816};var p=l.ECB=function(){q.apply(this,arguments)};var j=p.prototype=new q;j._doEncrypt=function(t,s,u){var w=t._blocksize*4;for(var v=0;v<s.length;v+=w){t._encryptblock(s,v)}};j._doDecrypt=function(s,w,t){var v=s._blocksize*4;for(var u=0;u<w.length;u+=v){s._decryptblock(w,u)}};j.fixOptions=function(s){s.iv=[]};var n=l.CBC=function(){q.apply(this,arguments)};var h=n.prototype=new q;h._doEncrypt=function(t,s,u){var x=t._blocksize*4;for(var w=0;w<s.length;w+=x){if(w==0){for(var v=0;v<x;v++){s[v]^=u[v]}}else{for(var v=0;v<x;v++){s[w+v]^=s[w+v-x]}}t._encryptblock(s,w)}};h._doDecrypt=function(s,z,u){var y=s._blocksize*4;var w=u;for(var x=0;x<z.length;x+=y){var t=z.slice(x,x+y);s._decryptblock(z,x);for(var v=0;v<y;v++){z[x+v]^=w[v]}w=t}};var g=l.CFB=function(){q.apply(this,arguments)};var d=g.prototype=new q;d._padding=m.NoPadding;d._doEncrypt=function(t,s,v){var y=t._blocksize*4,x=v.slice(0);for(var w=0;w<s.length;w++){var u=w%y;if(u==0){t._encryptblock(x,0)}s[w]^=x[u];x[u]=s[w]}};d._doDecrypt=function(t,z,v){var y=t._blocksize*4,x=v.slice(0);for(var w=0;w<z.length;w++){var u=w%y;if(u==0){t._encryptblock(x,0)}var s=z[w];z[w]^=x[u];x[u]=s}};var r=l.OFB=function(){q.apply(this,arguments)};var k=r.prototype=new q;k._padding=m.NoPadding;k._doEncrypt=function(t,s,u){var x=t._blocksize*4,w=u.slice(0);for(var v=0;v<s.length;v++){if(v%x==0){t._encryptblock(w,0)}s[v]^=w[v%x]}};k._doDecrypt=k._doEncrypt;var o=l.CTR=function(){q.apply(this,arguments)};var i=o.prototype=new q;i._padding=m.NoPadding;i._doEncrypt=function(t,s,w){var z=t._blocksize*4;var u=w.slice(0);for(var x=0;x<s.length;){var y=u.slice(0);t._encryptblock(y,0);for(var v=0;x<s.length&&v<z;v++,x++){s[x]^=y[v]}if(++(u[z-1])==256){u[z-1]=0;if(++(u[z-2])==256){u[z-2]=0;if(++(u[z-3])==256){u[z-3]=0;++(u[z-4])}}}}};i._doDecrypt=i._doEncrypt})(Crypto);(function(){var m=Crypto,b=m.util,v=m.charenc,t=v.UTF8;var w=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];for(var o=[],s=0;s<256;s++){o[w[s]]=s}var r=[],q=[],n=[],k=[],j=[],g=[];function h(z,y){for(var x=0,A=0;A<8;A++){if(y&1){x^=z}var B=z&128;z=(z<<1)&255;if(B){z^=27}y>>>=1}return x}for(var s=0;s<256;s++){r[s]=h(s,2);q[s]=h(s,3);n[s]=h(s,9);k[s]=h(s,11);j[s]=h(s,13);g[s]=h(s,14)}var l=[0,1,2,4,8,16,32,64,128,27,54];var e=[[],[],[],[]],f,d,u;var p=m.AES={encrypt:function(B,A,z){z=z||{};var C=z.mode||new m.mode.OFB;if(C.fixOptions){C.fixOptions(z)}var i=(B.constructor==String?t.stringToBytes(B):B),y=z.iv||b.randomBytes(p._blocksize*4),x=(A.constructor==String?m.PBKDF2(A,y,32,{asBytes:true}):A);p._init(x);C.encrypt(p,i,y);i=z.iv?i:y.concat(i);return(z&&z.asBytes)?i:b.bytesToBase64(i)},decrypt:function(A,z,y){y=y||{};var B=y.mode||new m.mode.OFB;if(B.fixOptions){B.fixOptions(y)}var C=(A.constructor==String?b.base64ToBytes(A):A),x=y.iv||C.splice(0,p._blocksize*4),i=(z.constructor==String?m.PBKDF2(z,x,32,{asBytes:true}):z);p._init(i);B.decrypt(p,C,x);return(y&&y.asBytes)?C:t.bytesToString(C)},_blocksize:4,_encryptblock:function(x,y){for(var E=0;E<p._blocksize;E++){for(var i=0;i<4;i++){e[E][i]=x[y+i*4+E]}}for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]^=u[i][E]}}for(var D=1;D<d;D++){for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]=w[e[E][i]]}}e[1].push(e[1].shift());e[2].push(e[2].shift());e[2].push(e[2].shift());e[3].unshift(e[3].pop());for(var i=0;i<4;i++){var C=e[0][i],B=e[1][i],A=e[2][i],z=e[3][i];e[0][i]=r[C]^q[B]^A^z;e[1][i]=C^r[B]^q[A]^z;e[2][i]=C^B^r[A]^q[z];e[3][i]=q[C]^B^A^r[z]}for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]^=u[D*4+i][E]}}}for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]=w[e[E][i]]}}e[1].push(e[1].shift());e[2].push(e[2].shift());e[2].push(e[2].shift());e[3].unshift(e[3].pop());for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]^=u[d*4+i][E]}}for(var E=0;E<p._blocksize;E++){for(var i=0;i<4;i++){x[y+i*4+E]=e[E][i]}}},_decryptblock:function(y,x){for(var E=0;E<p._blocksize;E++){for(var i=0;i<4;i++){e[E][i]=y[x+i*4+E]}}for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]^=u[d*4+i][E]}}for(var D=1;D<d;D++){e[1].unshift(e[1].pop());e[2].push(e[2].shift());e[2].push(e[2].shift());e[3].push(e[3].shift());for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]=o[e[E][i]]}}for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]^=u[(d-D)*4+i][E]}}for(var i=0;i<4;i++){var C=e[0][i],B=e[1][i],A=e[2][i],z=e[3][i];e[0][i]=g[C]^k[B]^j[A]^n[z];e[1][i]=n[C]^g[B]^k[A]^j[z];e[2][i]=j[C]^n[B]^g[A]^k[z];e[3][i]=k[C]^j[B]^n[A]^g[z]}}e[1].unshift(e[1].pop());e[2].push(e[2].shift());e[2].push(e[2].shift());e[3].push(e[3].shift());for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]=o[e[E][i]]}}for(var E=0;E<4;E++){for(var i=0;i<4;i++){e[E][i]^=u[i][E]}}for(var E=0;E<p._blocksize;E++){for(var i=0;i<4;i++){y[x+i*4+E]=e[E][i]}}},_init:function(i){f=i.length/4;d=f+6;p._keyexpansion(i)},_keyexpansion:function(x){u=[];for(var y=0;y<f;y++){u[y]=[x[y*4],x[y*4+1],x[y*4+2],x[y*4+3]]}for(var y=f;y<p._blocksize*(d+1);y++){var i=[u[y-1][0],u[y-1][1],u[y-1][2],u[y-1][3]];if(y%f==0){i.push(i.shift());i[0]=w[i[0]];i[1]=w[i[1]];i[2]=w[i[2]];i[3]=w[i[3]];i[0]^=l[y/f]}else{if(f>6&&y%f==4){i[0]=w[i[0]];i[1]=w[i[1]];i[2]=w[i[2]];i[3]=w[i[3]]}}u[y]=[u[y-f][0]^i[0],u[y-f][1]^i[1],u[y-f][2]^i[2],u[y-f][3]^i[3]]}}}})();"use strict";var c={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(b){this.toString=function(){return"CORRUPT: "+this.message};this.message=b},invalid:function(b){this.toString=function(){return"INVALID: "+this.message};this.message=b},bug:function(b){this.toString=function(){return"BUG: "+this.message};this.message=b},notReady:function(b){this.toString=function(){return"NOT READY: "+this.message};this.message=b}}};if(typeof module!="undefined"&&module.exports){module.exports=c}c.cipher.aes=function(l){if(!this._tables[0][0][0]){this._precompute()}var f,e,g,k,n,h=this._tables[0][4],m=this._tables[1],b=l.length,d=1;if(b!==4&&b!==6&&b!==8){throw new c.exception.invalid("invalid aes key size")}this._key=[k=l.slice(0),n=[]];for(f=b;f<4*b+28;f++){g=k[f-1];if(f%b===0||(b===8&&f%b===4)){g=h[g>>>24]<<24^h[g>>16&255]<<16^h[g>>8&255]<<8^h[g&255];if(f%b===0){g=g<<8^g>>>24^d<<24;d=d<<1^(d>>7)*283}}k[f]=k[f-b]^g}for(e=0;f;e++,f--){g=k[e&3?f:f-4];if(f<=4||e<4){n[e]=g}else{n[e]=m[0][h[g>>>24]]^m[1][h[g>>16&255]]^m[2][h[g>>8&255]]^m[3][h[g&255]]}}};c.cipher.aes.prototype={encrypt:function(b){return this._crypt(b,0)},decrypt:function(b){return this._crypt(b,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var l=this._tables[0],t=this._tables[1],k=l[4],p=t[4],j,n,h,m=[],f=[],e,r,o,q,g,b;for(j=0;j<256;j++){f[(m[j]=j<<1^(j>>7)*283)^j]=j}for(n=h=0;!k[n];n^=e||1,h=f[h]||1){q=h^h<<1^h<<2^h<<3^h<<4;q=q>>8^q&255^99;k[n]=q;p[q]=n;o=m[r=m[e=m[n]]];b=o*16843009^r*65537^e*257^n*16843008;g=m[q]*257^q*16843008;for(j=0;j<4;j++){l[j][n]=g=g<<24^g>>>8;t[j][q]=b=b<<24^b>>>8}}for(j=0;j<5;j++){l[j]=l[j].slice(0);t[j]=t[j].slice(0)}},_crypt:function(k,n){if(k.length!==4){throw new c.exception.invalid("invalid aes block size")}var y=this._key[n],v=k[0]^y[0],u=k[n?3:1]^y[1],t=k[2]^y[2],s=k[n?1:3]^y[3],w,e,m,x=y.length/4-2,p,o=4,q=[0,0,0,0],r=this._tables[n],j=r[0],h=r[1],g=r[2],f=r[3],l=r[4];for(p=0;p<x;p++){w=j[v>>>24]^h[u>>16&255]^g[t>>8&255]^f[s&255]^y[o];e=j[u>>>24]^h[t>>16&255]^g[s>>8&255]^f[v&255]^y[o+1];m=j[t>>>24]^h[s>>16&255]^g[v>>8&255]^f[u&255]^y[o+2];s=j[s>>>24]^h[v>>16&255]^g[u>>8&255]^f[t&255]^y[o+3];o+=4;v=w;u=e;t=m}for(p=0;p<4;p++){q[n?3&-p:p]=l[v>>>24]<<24^l[u>>16&255]<<16^l[t>>8&255]<<8^l[s&255]^y[o++];w=v;v=u;u=t;t=s;s=w}return q}};c.bitArray={bitSlice:function(b,d,e){b=c.bitArray._shiftRight(b.slice(d/32),32-(d&31)).slice(1);return(e===undefined)?b:c.bitArray.clamp(b,e-d)},extract:function(d,e,g){var b,f=Math.floor((-e-g)&31);if((e+g-1^e)&-32){b=(d[e/32|0]<<(32-f))^(d[e/32+1|0]>>>f)}else{b=d[e/32|0]>>>f}return b&((1<<g)-1)},concat:function(e,b){if(e.length===0||b.length===0){return e.concat(b)}var f,g,h=e[e.length-1],d=c.bitArray.getPartial(h);if(d===32){return e.concat(b)}else{return c.bitArray._shiftRight(b,d,h|0,e.slice(0,e.length-1))}},bitLength:function(e){var d=e.length,b;if(d===0){return 0}b=e[d-1];return(d-1)*32+c.bitArray.getPartial(b)},clamp:function(e,b){if(e.length*32<b){return e}e=e.slice(0,Math.ceil(b/32));var d=e.length;b=b&31;if(d>0&&b){e[d-1]=c.bitArray.partial(b,e[d-1]&2147483648>>(b-1),1)}return e},partial:function(d,b,e){if(d===32){return b}return(e?b|0:b<<(32-d))+d*1099511627776},getPartial:function(b){return Math.round(b/1099511627776)||32},equal:function(f,e){if(c.bitArray.bitLength(f)!==c.bitArray.bitLength(e)){return false}var d=0,g;for(g=0;g<f.length;g++){d|=f[g]^e[g]}return(d===0)},_shiftRight:function(e,d,j,g){var h,b=0,f;if(g===undefined){g=[]}for(;d>=32;d-=32){g.push(j);j=0}if(d===0){return g.concat(e)}for(h=0;h<e.length;h++){g.push(j|e[h]>>>d);j=e[h]<<(32-d)}b=e.length?e[e.length-1]:0;f=c.bitArray.getPartial(b);g.push(c.bitArray.partial(d+f&31,(d+f>32)?j:g.pop(),1));return g},_xor4:function(b,d){return[b[0]^d[0],b[1]^d[1],b[2]^d[2],b[3]^d[3]]}};c.hash.sha256=function(b){if(!this._key[0]){this._precompute()}if(b){this._h=b._h.slice(0);this._buffer=b._buffer.slice(0);this._length=b._length}else{this.reset()}};c.hash.sha256.hash=function(b){return(new c.hash.sha256()).update(b).finalize()};c.hash.sha256.prototype={blockSize:512,reset:function(){this._h=this._init.slice(0);this._buffer=[];this._length=0;return this},update:function(h){if(typeof h==="string"){h=c.codec.utf8String.toBits(h)}var g,d=this._buffer=c.bitArray.concat(this._buffer,h),f=this._length,e=this._length=f+c.bitArray.bitLength(h);for(g=512+f&-512;g<=e;g+=512){this._block(d.splice(0,16))}return this},finalize:function(){var e,d=this._buffer,f=this._h;d=c.bitArray.concat(d,[c.bitArray.partial(1,1)]);for(e=d.length+2;e&15;e++){d.push(0)}d.push(Math.floor(this._length/4294967296));d.push(this._length|0);while(d.length){this._block(d.splice(0,16))}this.reset();return f},_init:[],_key:[],_precompute:function(){var f=0,e=2,d;function b(g){return(g-Math.floor(g))*4294967296|0}outer:for(;f<64;e++){for(d=2;d*d<=e;d++){if(e%d===0){continue outer}}if(f<8){this._init[f]=b(Math.pow(e,1/2))}this._key[f]=b(Math.pow(e,1/3));f++}},_block:function(r){var f,g,u,t,v=r.slice(0),l=this._h,d=this._key,s=l[0],q=l[1],p=l[2],o=l[3],n=l[4],m=l[5],j=l[6],e=l[7];for(f=0;f<64;f++){if(f<16){g=v[f]}else{u=v[(f+1)&15];t=v[(f+14)&15];g=v[f&15]=((u>>>7^u>>>18^u>>>3^u<<25^u<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+v[f&15]+v[(f+9)&15])|0}g=(g+e+(n>>>6^n>>>11^n>>>25^n<<26^n<<21^n<<7)+(j^n&(m^j))+d[f]);e=j;j=m;m=n;n=o+g|0;o=p;p=q;q=s;s=(g+((q&p)^(o&(q^p)))+(q>>>2^q>>>13^q>>>22^q<<30^q<<19^q<<10))|0}l[0]=l[0]+s|0;l[1]=l[1]+q|0;l[2]=l[2]+p|0;l[3]=l[3]+o|0;l[4]=l[4]+n|0;l[5]=l[5]+m|0;l[6]=l[6]+j|0;l[7]=l[7]+e|0}};c.prng=function(b){this._pools=[new c.hash.sha256()];this._poolEntropy=[0];this._reseedCount=0;this._robins={};this._eventId=0;this._collectorIds={};this._collectorIdNext=0;this._strength=0;this._poolStrength=0;this._nextReseed=0;this._key=[0,0,0,0,0,0,0,0];this._counter=[0,0,0,0];this._cipher=undefined;this._defaultParanoia=b;this._collectorsStarted=false;this._callbacks={progress:{},seeded:{}};this._callbackI=0;this._NOT_READY=0;this._READY=1;this._REQUIRES_RESEED=2;this._MAX_WORDS_PER_BURST=65536;this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024];this._MILLISECONDS_PER_RESEED=30000;this._BITS_PER_RESEED=80;this._loadTimeCollector=this._loadTimeCollector.bind(this);this._mouseCollector=this._mouseCollector.bind(this)};c.prng.prototype={randomWords:function(b,j){var d=[],f,e=this.isReady(j),h;if(e===this._NOT_READY){throw new c.exception.notReady("generator isn't seeded")}else{if(e&this._REQUIRES_RESEED){this._reseedFromPools(!(e&this._READY))}}for(f=0;f<b;f+=4){if((f+1)%this._MAX_WORDS_PER_BURST===0){this._gate()}h=this._gen4words();d.push(h[0],h[1],h[2],h[3])}this._gate();return d.slice(0,b)},setDefaultParanoia:function(d,b){if(d===0&&b!=="Setting paranoia=0 will ruin your security; use it only for testing"){throw"Setting paranoia=0 will ruin your security; use it only for testing"}this._defaultParanoia=d},addEntropy:function(g,n,b){b=b||"user";var d,h,j,l=(new Date()).valueOf(),e=this._robins[b],m=this.isReady(),f=0,k;d=this._collectorIds[b];if(d===undefined){d=this._collectorIds[b]=this._collectorIdNext++}if(e===undefined){e=this._robins[b]=0}this._robins[b]=(this._robins[b]+1)%this._pools.length;switch(typeof(g)){case"number":if(n===undefined){n=1}this._pools[e].update([d,this._eventId++,1,n,l,1,g|0]);break;case"object":k=Object.prototype.toString.call(g);if(k==="[object Uint32Array]"){j=[];for(h=0;h<g.length;h++){j.push(g[h])}g=j}else{if(k!=="[object Array]"){f=1}for(h=0;h<g.length&&!f;h++){if(typeof(g[h])!=="number"){f=1}}}if(!f){if(n===undefined){n=0;for(h=0;h<g.length;h++){j=g[h];while(j>0){n++;j=j>>>1}}}this._pools[e].update([d,this._eventId++,2,n,l,g.length].concat(g))}break;case"string":if(n===undefined){n=g.length}this._pools[e].update([d,this._eventId++,3,n,l,g.length]);this._pools[e].update(g);break;default:f=1}if(f){throw new c.exception.bug("random: addEntropy only supports number, array of numbers or string")}this._poolEntropy[e]+=n;this._poolStrength+=n;if(m===this._NOT_READY){if(this.isReady()!==this._NOT_READY){this._fireEvent("seeded",Math.max(this._strength,this._poolStrength))}this._fireEvent("progress",this.getProgress())}},isReady:function(d){var b=this._PARANOIA_LEVELS[(d!==undefined)?d:this._defaultParanoia];if(this._strength&&this._strength>=b){return(this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date()).valueOf()>this._nextReseed)?this._REQUIRES_RESEED|this._READY:this._READY}else{return(this._poolStrength>=b)?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY}},getProgress:function(d){var b=this._PARANOIA_LEVELS[d?d:this._defaultParanoia];if(this._strength>=b){return 1}else{return(this._poolStrength>b)?1:this._poolStrength/b}},startCollectors:function(){if(this._collectorsStarted){return}if(window.addEventListener){window.addEventListener("load",this._loadTimeCollector,false);window.addEventListener("mousemove",this._mouseCollector,false)}else{if(document.attachEvent){document.attachEvent("onload",this._loadTimeCollector);document.attachEvent("onmousemove",this._mouseCollector)}else{throw new c.exception.bug("can't attach event")}}this._collectorsStarted=true},stopCollectors:function(){if(!this._collectorsStarted){return}if(window.removeEventListener){window.removeEventListener("load",this._loadTimeCollector,false);window.removeEventListener("mousemove",this._mouseCollector,false)}else{if(window.detachEvent){window.detachEvent("onload",this._loadTimeCollector);window.detachEvent("onmousemove",this._mouseCollector)}}this._collectorsStarted=false},addEventListener:function(b,d){this._callbacks[b][this._callbackI++]=d},removeEventListener:function(g,b){var h,f,e=this._callbacks[g],d=[];for(f in e){if(e.hasOwnProperty(f)&&e[f]===b){d.push(f)}}for(h=0;h<d.length;h++){f=d[h];delete e[f]}},_gen4words:function(){for(var b=0;b<4;b++){this._counter[b]=this._counter[b]+1|0;if(this._counter[b]){break}}return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words());this._cipher=new c.cipher.aes(this._key)},_reseed:function(d){this._key=c.hash.sha256.hash(this._key.concat(d));this._cipher=new c.cipher.aes(this._key);for(var b=0;b<4;b++){this._counter[b]=this._counter[b]+1|0;if(this._counter[b]){break}}},_reseedFromPools:function(e){var b=[],f=0,d;this._nextReseed=b[0]=(new Date()).valueOf()+this._MILLISECONDS_PER_RESEED;for(d=0;d<16;d++){b.push(Math.random()*4294967296|0)}for(d=0;d<this._pools.length;d++){b=b.concat(this._pools[d].finalize());f+=this._poolEntropy[d];this._poolEntropy[d]=0;if(!e&&(this._reseedCount&(1<<d))){break}}if(this._reseedCount>=1<<this._pools.length){this._pools.push(new c.hash.sha256());this._poolEntropy.push(0)}this._poolStrength-=f;if(f>this._strength){this._strength=f}this._reseedCount++;this._reseed(b)},_mouseCollector:function(d){var b=d.x||d.clientX||d.offsetX||0,e=d.y||d.clientY||d.offsetY||0;c.random.addEntropy([b,e],2,"mouse");this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(b){if(window&&window.performance&&typeof window.performance.now==="function"){c.random.addEntropy(window.performance.now(),b,"loadtime")}else{c.random.addEntropy((new Date()).valueOf(),b,"loadtime")}},_fireEvent:function(f,b){var e,d=c.random._callbacks[f],g=[];for(e in d){if(d.hasOwnProperty(e)){g.push(d[e])}}for(e=0;e<g.length;e++){g[e](b)}}};c.random=new c.prng(6);(function(){try{var d,g,b,f;if(typeof module!=="undefined"&&module.exports){g=require("crypto");d=g.randomBytes(1024/8);c.random.addEntropy(d,1024,"crypto.randomBytes")}else{if(window){if(window.crypto&&window.crypto.getRandomValues){b=window.crypto.getRandomValues}else{if(window.msCrypto&&window.msCrypto.getRandomValues){b=window.msCrypto.getRandomValues}}if(b){f=new Uint32Array(32);b(f);c.random.addEntropy(f,1024,"crypto.getRandomValues")}}else{}}}catch(h){}}());var a={decrypt:function(b,d){return Crypto.AES.decrypt(d,b)},encrypt:function(b,d){return Crypto.AES.decrypt(d,b)},sha:function(b){return Crypto.SHA1(b)},randomKey:function(e){var b=false;if(!c.random.isReady()){if(!c.random._collectorsStarted){c.random.startCollectors();b=true}setTimeout(function(){a.randomKey(e);if(b){c.random.stopCollectors()}},200);return}var d=Crypto.util.bytesToBase64(Crypto.util.wordsToBytes(c.random.randomWords(8)));e(d)},};if(!window.crypto_backends){window.crypto_backends={}}window.crypto_backends.CRYPTO_JS=a;if(!window.ezcrypt_backend){window.ezcrypt_backend=a}})();