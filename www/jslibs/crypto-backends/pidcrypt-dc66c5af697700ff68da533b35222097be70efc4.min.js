(function(){pidCryptUtil={};pidCryptUtil.encodeBase64=function(o,q){if(!o){o=""}var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";q=(typeof q=="undefined")?false:q;var g,d,b,s,p,l,k,i,j=[],f="",n,r,m;r=q?pidCryptUtil.encodeUTF8(o):o;n=r.length%3;if(n>0){while(n++<3){f+="=";r+="0"}}for(n=0;n<r.length;n+=3){g=r.charCodeAt(n);d=r.charCodeAt(n+1);b=r.charCodeAt(n+2);s=g<<16|d<<8|b;p=s>>18&63;l=s>>12&63;k=s>>6&63;i=s&63;j[n/3]=h.charAt(p)+h.charAt(l)+h.charAt(k)+h.charAt(i)}m=j.join("");m=m.slice(0,m.length-f.length)+f;return m};pidCryptUtil.decodeBase64=function(o,f){if(!o){o=""}var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";f=(typeof f=="undefined")?false:f;var g,e,b,p,l,j,i,r,k=[],q,n;n=f?pidCryptUtil.decodeUTF8(o):o;for(var m=0;m<n.length;m+=4){p=h.indexOf(n.charAt(m));l=h.indexOf(n.charAt(m+1));j=h.indexOf(n.charAt(m+2));i=h.indexOf(n.charAt(m+3));r=p<<18|l<<12|j<<6|i;g=r>>>16&255;e=r>>>8&255;b=r&255;k[m/4]=String.fromCharCode(g,e,b);if(i==64){k[m/4]=String.fromCharCode(g,e)}if(j==64){k[m/4]=String.fromCharCode(g)}}q=k.join("");q=f?pidCryptUtil.decodeUTF8(q):q;return q};pidCryptUtil.encodeUTF8=function(b){if(!b){b=""}b=b.replace(/[u0080-u07ff]/g,function(e){var d=e.charCodeAt(0);return String.fromCharCode(192|d>>6,128|d&63)});b=b.replace(/[u0800-uffff]/g,function(e){var d=e.charCodeAt(0);return String.fromCharCode(224|d>>12,128|d>>6&63,128|d&63)});return b};pidCryptUtil.decodeUTF8=function(b){if(!b){b=""}b=b.replace(/[u00c0-u00df][u0080-u00bf]/g,function(e){var d=(e.charCodeAt(0)&31)<<6|e.charCodeAt(1)&63;return String.fromCharCode(d)});b=b.replace(/[u00e0-u00ef][u0080-u00bf][u0080-u00bf]/g,function(e){var d=((e.charCodeAt(0)&15)<<12)|((e.charCodeAt(1)&63)<<6)|(e.charCodeAt(2)&63);return String.fromCharCode(d)});return b};pidCryptUtil.convertToHex=function(f){if(!f){f=""}var e="";var b="";for(var d=0;d<f.length;d++){b=f.charCodeAt(d).toString(16);e+=(b.length==1)?"0"+b:b}return e};pidCryptUtil.convertFromHex=function(e){if(!e){e=""}var d="";for(var b=0;b<e.length;b+=2){d+=String.fromCharCode(parseInt(e.substring(b,b+2),16))}return d};pidCryptUtil.stripLineFeeds=function(d){if(!d){d=""}var b="";b=d.replace(/n/g,"");b=b.replace(/r/g,"");return b};pidCryptUtil.toByteArray=function(d){if(!d){d=""}var e=[];for(var b=0;b<d.length;b++){e[b]=d.charCodeAt(b)}return e};pidCryptUtil.fragment=function(g,f,b){if(!g){g=""}if(!f||f>=g.length){return g}if(!b){b="n"}var e="";for(var d=0;d<g.length;d+=f){e+=g.substr(d,f)+b}return e};pidCryptUtil.formatHex=function(h,g){if(!h){h=""}if(!g){g=45}var b="";var d=0;var f=h.toLowerCase();for(var e=0;e<f.length;e+=2){b+=f.substr(e,2)+":"}f=this.fragment(b,g);return f};pidCryptUtil.byteArray2String=function(d){var f="";for(var e=0;e<d.length;e++){f+=String.fromCharCode(d[e])}return f}
/*Copyright (c) 2009 pidder <www.pidder.com>*/
;function c(){function b(d){if(!d){d=8}var e=new Array(d);var g=[];for(var f=0;f<256;f++){g[f]=f}for(f=0;f<e.length;f++){e[f]=g[Math.floor(Math.random()*g.length)]}return e}this.setDefaults=function(){this.params.nBits=256;this.params.salt=b(8);this.params.salt=pidCryptUtil.byteArray2String(this.params.salt);this.params.salt=pidCryptUtil.convertToHex(this.params.salt);this.params.blockSize=16;this.params.UTF8=true;this.params.A0_PAD=true};this.debug=true;this.params={};this.params.dataIn="";this.params.dataOut="";this.params.decryptIn="";this.params.decryptOut="";this.params.encryptIn="";this.params.encryptOut="";this.params.key="";this.params.iv="";this.params.clear=true;this.setDefaults();this.errors="";this.warnings="";this.infos="";this.debugMsg="";this.setParams=function(e){if(!e){e={}}for(var d in e){this.params[d]=e[d]}};this.getParams=function(){return this.params};this.getParam=function(d){return this.params[d]||""};this.clearParams=function(){this.params={}};this.getNBits=function(){return this.params.nBits};this.getOutput=function(){return this.params.dataOut};this.setError=function(d){this.error=d};this.appendError=function(d){this.errors+=d;return""};this.getErrors=function(){return this.errors};this.isError=function(){if(this.errors.length>0){return true}return false};this.appendInfo=function(d){this.infos+=d;return""};this.getInfos=function(){return this.infos};this.setDebug=function(d){this.debug=d};this.appendDebug=function(d){this.debugMsg+=d;return""};this.isDebug=function(){return this.debug};this.getAllMessages=function(f){var i={lf:"n",clr_mes:false,verbose:15};if(!f){f=i}for(var j in i){if(typeof(f[j])=="undefined"){f[j]=i[j]}}var e="";var g="";for(var h in this.params){switch(h){case"encryptOut":g=pidCryptUtil.toByteArray(this.params[h].toString());g=pidCryptUtil.fragment(g.join(),64,f.lf);break;case"key":case"iv":g=pidCryptUtil.formatHex(this.params[h],48);break;default:g=pidCryptUtil.fragment(this.params[h].toString(),64,f.lf)}e+="<p><b>"+h+"</b>:<pre>"+g+"</pre></p>"}if(this.debug){e+="debug: "+this.debug+f.lf}if(this.errors.length>0&&((f.verbose&1)==1)){e+="Errors:"+f.lf+this.errors+f.lf}if(this.warnings.length>0&&((f.verbose&2)==2)){e+="Warnings:"+f.lf+this.warnings+f.lf}if(this.infos.length>0&&((f.verbose&4)==4)){e+="Infos:"+f.lf+this.infos+f.lf}if(this.debug&&((f.verbose&8)==8)){e+="Debug messages:"+f.lf+this.debugMsg+f.lf}if(f.clr_mes){this.errors=this.infos=this.warnings=this.debug=""}return e};this.getRandomBytes=function(d){return b(d)}}if(typeof(c)!="undefined"){c.MD5=function(s){function K(d,b){return(d<<b)|(d>>>(32-b))}function J(F,d){var H,b,x,G,k;x=(F&2147483648);G=(d&2147483648);H=(F&1073741824);b=(d&1073741824);k=(F&1073741823)+(d&1073741823);if(H&b){return(k^2147483648^x^G)}if(H|b){if(k&1073741824){return(k^3221225472^x^G)}else{return(k^1073741824^x^G)}}else{return(k^x^G)}}function r(b,k,d){return(b&k)|((~b)&d)}function q(b,k,d){return(b&d)|(k&(~d))}function p(b,k,d){return(b^k^d)}function n(b,k,d){return(k^(b|(~d)))}function u(G,F,Z,Y,k,H,I){G=J(G,J(J(r(F,Z,Y),k),I));return J(K(G,H),F)}function f(G,F,Z,Y,k,H,I){G=J(G,J(J(q(F,Z,Y),k),I));return J(K(G,H),F)}function D(G,F,Z,Y,k,H,I){G=J(G,J(J(p(F,Z,Y),k),I));return J(K(G,H),F)}function t(G,F,Z,Y,k,H,I){G=J(G,J(J(n(F,Z,Y),k),I));return J(K(G,H),F)}function e(F){var I;var x=F.length;var k=x+8;var d=(k-(k%64))/64;var H=(d+1)*16;var Y=Array(H-1);var b=0;var G=0;while(G<x){I=(G-(G%4))/4;b=(G%4)*8;Y[I]=(Y[I]|(F.charCodeAt(G)<<b));G++}I=(G-(G%4))/4;b=(G%4)*8;Y[I]=Y[I]|(128<<b);Y[H-2]=x<<3;Y[H-1]=x>>>29;return Y}function B(k){var d="",x="",F,b;for(b=0;b<=3;b++){F=(k>>>(b*8))&255;x="0"+F.toString(16);d=d+x.substr(x.length-2,2)}return d}var C=Array();var O,h,E,v,g,X,W,V,U;var R=7,P=12,M=17,L=22;var A=5,z=9,y=14,w=20;var o=4,m=11,l=16,j=23;var T=6,S=10,Q=15,N=21;C=e(s);X=1732584193;W=4023233417;V=2562383102;U=271733878;for(O=0;O<C.length;O+=16){h=X;E=W;v=V;g=U;X=u(X,W,V,U,C[O+0],R,3614090360);U=u(U,X,W,V,C[O+1],P,3905402710);V=u(V,U,X,W,C[O+2],M,606105819);W=u(W,V,U,X,C[O+3],L,3250441966);X=u(X,W,V,U,C[O+4],R,4118548399);U=u(U,X,W,V,C[O+5],P,1200080426);V=u(V,U,X,W,C[O+6],M,2821735955);W=u(W,V,U,X,C[O+7],L,4249261313);X=u(X,W,V,U,C[O+8],R,1770035416);U=u(U,X,W,V,C[O+9],P,2336552879);V=u(V,U,X,W,C[O+10],M,4294925233);W=u(W,V,U,X,C[O+11],L,2304563134);X=u(X,W,V,U,C[O+12],R,1804603682);U=u(U,X,W,V,C[O+13],P,4254626195);V=u(V,U,X,W,C[O+14],M,2792965006);W=u(W,V,U,X,C[O+15],L,1236535329);X=f(X,W,V,U,C[O+1],A,4129170786);U=f(U,X,W,V,C[O+6],z,3225465664);V=f(V,U,X,W,C[O+11],y,643717713);W=f(W,V,U,X,C[O+0],w,3921069994);X=f(X,W,V,U,C[O+5],A,3593408605);U=f(U,X,W,V,C[O+10],z,38016083);V=f(V,U,X,W,C[O+15],y,3634488961);W=f(W,V,U,X,C[O+4],w,3889429448);X=f(X,W,V,U,C[O+9],A,568446438);U=f(U,X,W,V,C[O+14],z,3275163606);V=f(V,U,X,W,C[O+3],y,4107603335);W=f(W,V,U,X,C[O+8],w,1163531501);X=f(X,W,V,U,C[O+13],A,2850285829);U=f(U,X,W,V,C[O+2],z,4243563512);V=f(V,U,X,W,C[O+7],y,1735328473);W=f(W,V,U,X,C[O+12],w,2368359562);X=D(X,W,V,U,C[O+5],o,4294588738);U=D(U,X,W,V,C[O+8],m,2272392833);V=D(V,U,X,W,C[O+11],l,1839030562);W=D(W,V,U,X,C[O+14],j,4259657740);X=D(X,W,V,U,C[O+1],o,2763975236);U=D(U,X,W,V,C[O+4],m,1272893353);V=D(V,U,X,W,C[O+7],l,4139469664);W=D(W,V,U,X,C[O+10],j,3200236656);X=D(X,W,V,U,C[O+13],o,681279174);U=D(U,X,W,V,C[O+0],m,3936430074);V=D(V,U,X,W,C[O+3],l,3572445317);W=D(W,V,U,X,C[O+6],j,76029189);X=D(X,W,V,U,C[O+9],o,3654602809);U=D(U,X,W,V,C[O+12],m,3873151461);V=D(V,U,X,W,C[O+15],l,530742520);W=D(W,V,U,X,C[O+2],j,3299628645);X=t(X,W,V,U,C[O+0],T,4096336452);U=t(U,X,W,V,C[O+7],S,1126891415);V=t(V,U,X,W,C[O+14],Q,2878612391);W=t(W,V,U,X,C[O+5],N,4237533241);X=t(X,W,V,U,C[O+12],T,1700485571);U=t(U,X,W,V,C[O+3],S,2399980690);V=t(V,U,X,W,C[O+10],Q,4293915773);W=t(W,V,U,X,C[O+1],N,2240044497);X=t(X,W,V,U,C[O+8],T,1873313359);U=t(U,X,W,V,C[O+15],S,4264355552);V=t(V,U,X,W,C[O+6],Q,2734768916);W=t(W,V,U,X,C[O+13],N,1309151649);X=t(X,W,V,U,C[O+4],T,4149444226);U=t(U,X,W,V,C[O+11],S,3174756917);V=t(V,U,X,W,C[O+2],Q,718787259);W=t(W,V,U,X,C[O+9],N,3951481745);X=J(X,h);W=J(W,E);V=J(V,v);U=J(U,g)}var i=B(X)+B(W)+B(V)+B(U);return i.toLowerCase()};
/*Copyright (c) 2009 pidder <www.pidder.com>*/
}if(typeof(c)!="undefined"){c.AES=function(b){this.env=(b)?b:new c();this.blockSize=16;this.ShiftRowTabInv;this.xtime;this.SBox=new Array(99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22);this.SBoxInv=new Array(82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125);this.ShiftRowTab=new Array(0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11)};c.AES.prototype.init=function(){this.env.setParams({blockSize:this.blockSize});this.ShiftRowTabInv=new Array(16);for(var b=0;b<16;b++){this.ShiftRowTabInv[this.ShiftRowTab[b]]=b}this.xtime=new Array(256);for(b=0;b<128;b++){this.xtime[b]=b<<1;this.xtime[128+b]=(b<<1)^27}};c.AES.prototype.expandKey=function(d){var g=d.slice();var h=g.length,l,k=1;switch(h){case 16:l=16*(10+1);break;case 24:l=16*(12+1);break;case 32:l=16*(14+1);break;default:alert("AESCore.expandKey: Only key lengths of 16, 24 or 32 bytes allowed!")}for(var f=h;f<l;f+=4){var b=g.slice(f-4,f);if(f%h==0){b=new Array(this.SBox[b[1]]^k,this.SBox[b[2]],this.SBox[b[3]],this.SBox[b[0]]);if((k<<=1)>=256){k^=283}}else{if((h>24)&&(f%h==16)){b=new Array(this.SBox[b[0]],this.SBox[b[1]],this.SBox[b[2]],this.SBox[b[3]])}}for(var e=0;e<4;e++){g[f+e]=g[f+e-h]^b[e]}}return g};c.AES.prototype.encrypt=function(d,f){var b=f.length;var g=d.slice();this.addRoundKey(g,f.slice(0,16));for(var e=16;e<b-16;e+=16){this.subBytes(g);this.shiftRows(g);this.mixColumns(g);this.addRoundKey(g,f.slice(e,e+16))}this.subBytes(g);this.shiftRows(g);this.addRoundKey(g,f.slice(e,b));return g};c.AES.prototype.decrypt=function(d,f){var b=f.length;var g=d.slice();this.addRoundKey(g,f.slice(b-16,b));this.shiftRows(g,1);this.subBytes(g,1);for(var e=b-32;e>=16;e-=16){this.addRoundKey(g,f.slice(e,e+16));this.mixColumns_Inv(g);this.shiftRows(g,1);this.subBytes(g,1)}this.addRoundKey(g,f.slice(0,16));return g};c.AES.prototype.subBytes=function(f,b){var e=(typeof(b)=="undefined")?this.SBox.slice():this.SBoxInv.slice();for(var d=0;d<16;d++){f[d]=e[f[d]]}};c.AES.prototype.addRoundKey=function(e,b){for(var d=0;d<16;d++){e[d]^=b[d]}};c.AES.prototype.shiftRows=function(f,b){var g=(typeof(b)=="undefined")?this.ShiftRowTab.slice():this.ShiftRowTabInv.slice();var e=new Array().concat(f);for(var d=0;d<16;d++){f[d]=e[g[d]]}};c.AES.prototype.mixColumns=function(k){for(var f=0;f<16;f+=4){var j=k[f+0],e=k[f+1];var d=k[f+2],b=k[f+3];var g=j^e^d^b;k[f+0]^=g^this.xtime[j^e];k[f+1]^=g^this.xtime[e^d];k[f+2]^=g^this.xtime[d^b];k[f+3]^=g^this.xtime[b^j]}};c.AES.prototype.mixColumns_Inv=function(b){for(var d=0;d<16;d+=4){var n=b[d+0],m=b[d+1];var l=b[d+2],k=b[d+3];var e=n^m^l^k;var j=this.xtime[e];var g=this.xtime[this.xtime[j^n^l]]^e;var f=this.xtime[this.xtime[j^m^k]]^e;b[d+0]^=g^this.xtime[n^m];b[d+1]^=f^this.xtime[m^l];b[d+2]^=g^this.xtime[l^k];b[d+3]^=f^this.xtime[k^n]}};c.AES.prototype.xOr_Array=function(d,b){var f;var e=Array();for(f=0;f<d.length;f++){e[f]=d[f]^b[f]}return e};c.AES.prototype.getCounterBlock=function(){var d=new Array(this.blockSize);var g=(new Date()).getTime();var f=Math.floor(g/1000);var b=g%1000;for(var e=0;e<4;e++){d[e]=(f>>>e*8)&255}for(var e=0;e<4;e++){d[e+4]=b&255}return d.slice()}}if(typeof(c)!="undefined"&&typeof(c.AES)!="undefined"&&typeof(c.MD5)!="undefined"){c.AES.CBC=function(){this.pidcrypt=new c();this.aes=new c.AES(this.pidcrypt);this.getOutput=function(){return this.pidcrypt.getOutput()};this.getAllMessages=function(b){return this.pidcrypt.getAllMessages(b)};this.isError=function(){return this.pidcrypt.isError()}};c.AES.CBC.prototype.init=function(d,b){if(!b){b={}}var h=this.pidcrypt;h.setDefaults();var g=this.pidcrypt.getParams();for(var f in b){g[f]=b[f]}var e=this.createKeyAndIv({password:d,salt:g.salt,bits:g.nBits});g.key=e.key;g.iv=e.iv;g.dataOut="";h.setParams(g);this.aes.init()};c.AES.CBC.prototype.initEncrypt=function(e,d,b){this.init(d,b);this.pidcrypt.setParams({dataIn:e,encryptIn:pidCryptUtil.toByteArray(e)})};c.AES.CBC.prototype.initDecrypt=function(g,d,b){if(!b){b={}}var h=this.pidcrypt;h.setParams({dataIn:g});if(!d){h.appendError("pidCrypt.AES.CBC.initFromEncryption: Sorry, can not crypt or decrypt without password.n")}var f=pidCryptUtil.decodeBase64(g);if(f.indexOf("Salted__")!=0){h.appendError("pidCrypt.AES.CBC.initFromCrypt: Sorry, unknown encryption method.n")}var e=f.substr(8,8);b.salt=pidCryptUtil.convertToHex(e);this.init(d,b);f=f.substr(16);h.setParams({decryptIn:pidCryptUtil.toByteArray(f)})};c.AES.CBC.prototype.initByValues=function(e,f,d,b){var g={};this.init("",b);g.dataIn=e;g.key=f;g.iv=d;this.pidcrypt.setParams(g)};c.AES.CBC.prototype.getAllMessages=function(b){return this.pidcrypt.getAllMessages(b)};c.AES.CBC.prototype.createKeyAndIv=function(d){var k=this.pidcrypt;var i={};var m=1;var e="3";if(!d){d={}}if(!d.salt){d.salt=k.getRandomBytes(8);d.salt=pidCryptUtil.convertToHex(pidCryptUtil.byteArray2String(d.salt));k.setParams({salt:d.salt})}var f=d.password+pidCryptUtil.convertFromHex(d.salt);var b="";var o="";var g=[];var l=0;g[l++]=f;for(var h=0;h<e;h++){if(h==0){o=f}else{b=pidCryptUtil.convertFromHex(o);b+=f;o=b}for(var n=0;n<m;n++){o=c.MD5(o)}g[l++]=o}switch(d.bits){case 128:i.key=g[1];i.iv=g[2];break;case 192:i.key=g[1]+g[2].substr(0,16);i.iv=g[3];break;case 256:i.key=g[1]+g[2];i.iv=g[3];break;default:k.appendError("pidCrypt.AES.CBC.createKeyAndIv: Sorry, only 128, 192 and 256 bits are supported.nBits("+typeof(d.bits)+") = "+d.bits)}return i};c.AES.CBC.prototype.encryptRaw=function(j){var d=this.pidcrypt;var l=this.aes;var m=d.getParams();if(!j){j=m.encryptIn}d.setParams({encryptIn:j});if(!m.dataIn){d.setParams({dataIn:j})}var e=pidCryptUtil.convertFromHex(m.iv);var k=m.blockSize-((j.length+1)%m.blockSize);if(m.A0_PAD){j[j.length]=10}for(var s=0;s<k;s++){j[j.length]=k}var g=Math.floor(m.nBits/8);var n=new Array(g);var w=pidCryptUtil.convertFromHex(m.key);for(var q=0;q<g;q++){n[q]=isNaN(w.charCodeAt(q))?0:w.charCodeAt(q)}var t=l.expandKey(n);var o=Math.ceil(j.length/m.blockSize);var h=new Array(o);var r=[];var f=pidCryptUtil.toByteArray(e);for(var u=0;u<o;u++){r=j.slice(u*m.blockSize,u*m.blockSize+m.blockSize);f=l.xOr_Array(f,r);f=l.encrypt(f.slice(),t);h[u]=pidCryptUtil.byteArray2String(f)}var v=h.join("");d.setParams({dataOut:v,encryptOut:v});if(!d.isDebug()&&d.clear){d.clearParams()}return v||""};c.AES.CBC.prototype.encrypt=function(e){var g=this.pidcrypt;var b="";var f=g.getParams();if(!e){e=f.dataIn}if(f.UTF8){e=pidCryptUtil.encodeUTF8(e)}g.setParams({dataIn:e,encryptIn:pidCryptUtil.toByteArray(e)});var d=this.encryptRaw();b="Salted__"+pidCryptUtil.convertFromHex(f.salt);d=b+d;d=pidCryptUtil.encodeBase64(d);g.setParams({dataOut:d});if(!g.isDebug()&&g.clear){g.clearParams()}return d||""};c.AES.CBC.prototype.encryptText=function(e,d,b){this.initEncrypt(e,d,b);return this.encrypt()};c.AES.CBC.prototype.decryptRaw=function(m){var q=this.aes;var e=this.pidcrypt;var r=e.getParams();if(!m){m=r.decryptIn}e.setParams({decryptIn:m});if(!r.dataIn){e.setParams({dataIn:m})}if((r.iv.length/2)<r.blockSize){return e.appendError("pidCrypt.AES.CBC.decrypt: Sorry, can not decrypt without complete set of parameters.n Length of key,iv:"+r.key.length+","+r.iv.length)}var h=pidCryptUtil.convertFromHex(r.iv);if(m.length%r.blockSize!=0){return e.appendError("pidCrypt.AES.CBC.decrypt: Sorry, the encrypted text has the wrong length for aes-cbc moden Length of ciphertext:"+m.length+m.length%r.blockSize)}var l=Math.floor(r.nBits/8);var s=new Array(l);var y=pidCryptUtil.convertFromHex(r.key);for(var u=0;u<l;u++){s[u]=isNaN(y.charCodeAt(u))?0:y.charCodeAt(u)}var v=q.expandKey(s);var g=Math.ceil((m.length)/r.blockSize);var d=new Array(g.length);var j=pidCryptUtil.toByteArray(h);var f=[];var x=[];for(var w=0;w<g;w++){f=m.slice(w*r.blockSize,w*r.blockSize+r.blockSize);x=q.decrypt(f,v);d[w]=pidCryptUtil.byteArray2String(q.xOr_Array(j,x));j=f.slice()}var k=d.join("");if(e.isDebug()){e.appendDebug("Padding after decryption:"+pidCryptUtil.convertToHex(k)+":"+k.length+"n")}var t=k.charCodeAt(k.length-1);if(r.A0_PAD){k=k.substr(0,k.length-(t+1))}else{var n=k.length-(k.length-t);var o=k.charCodeAt(k.length-t);if(t==o&&t==n){k=k.substr(0,k.length-t)}}e.setParams({dataOut:k,decryptOut:k});if(!e.isDebug()&&e.clear){e.clearParams()}return k||""};c.AES.CBC.prototype.decrypt=function(e){var g=this.pidcrypt;var f=g.getParams();if(e){g.setParams({dataIn:e})}if(!f.decryptIn){var b=pidCryptUtil.decodeBase64(f.dataIn);if(b.indexOf("Salted__")==0){b=b.substr(16)}g.setParams({decryptIn:pidCryptUtil.toByteArray(b)})}var d=this.decryptRaw();if(f.UTF8){d=pidCryptUtil.decodeUTF8(d)}if(g.isDebug()){g.appendDebug("Removed Padding after decryption:"+pidCryptUtil.convertToHex(d)+":"+d.length+"n")}g.setParams({dataOut:d});if(!g.isDebug()&&g.clear){g.clearParams()}return d||""};c.AES.CBC.prototype.decryptText=function(e,d,b){this.initDecrypt(e,d,b);return this.decrypt()}}var a={decrypt:function(b,d){return c.AES.CBC.decryptText(d,b,{nBits:128})},encrypt:function(b,d){return c.AES.CBC.encryptText(d,b,{nBits:128})},sha:function(b){return c.SHA1(b)},randomKey:function(f){var b="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";var e="";for(var d=1;d<25;d++){e+=b[Math.floor(Math.random()*b.length)]}f(e)},};if(!window.crypto_backends){window.crypto_backends={}}window.crypto_backends.PIDCRYPT=a;if(!window.ezcrypt_backend){window.ezcrypt_backend=a}})();