$(function(){var editor;var _encrypting=null;var __timer_decryption;var __timer_encryption;var __timer_coloring;var __timer_total;var timeDiff={time:undefined,setStartTime:function(){var d=new Date;this.time=d.getTime()},getDiff:function(){var d=new Date;return d.getTime()-this.time}};function stringBreak(str,col){var result="";for(var i=0;i<str.length;i++){result+=str.charAt(i);if((i+1)%col==0&&0<i){result+="\n"}}return result}function enableHover(){$("#en").hover(function(){$("#result").show();$("#encrypttime").show()},function(){$("#result").hide();$("#encrypttime").hide()})}function onCodeChange(){__timer_coloring=timeDiff.getDiff();$("#coloring").html("syntax: "+__timer_coloring+"ms,");__timer_total=__timer_decryption+__timer_coloring;$("#totaltime").html("total: "+__timer_total+"ms")}function decrypt(key,data){$("#decrypting").show();$("#insertkey").hide();timeDiff.setStartTime();var output=window.ezcrypt_backend.decrypt(key,data);__timer_decryption=timeDiff.getDiff();timeDiff.setStartTime();$("#wrapholder").show();$("#execute").html("decryption: "+__timer_decryption+"ms,");$(".cm-s-default").parent().show();$("#decrypting").hide();return output}function encrypt(key,data){timeDiff.setStartTime();var encrypt=stringBreak(window.ezcrypt_backend.encrypt(key,data),96);__timer_encryption=timeDiff.getDiff();$("#encrypttime").html("encryption: "+__timer_encryption+"ms");return encrypt}function requestData(){var password=window.ezcrypt_backend.sha($("#typepassword").val());var url=window.location.href;var hash=window.location.hash;var index_of_hash=url.indexOf(hash)||url.length;var hashless_url=url.substr(0,index_of_hash);$.ajax({url:hashless_url,type:"POST",dataType:"json",data:"p="+password,cache:false,success:function(json){$("#data").val(json.data);$("#syntax").val(json.syntax);editor.setOption("mode",$("#syntax").val());if(hash==""){$("#askpassword").hide();$("#insertkey").show();$("#typekey").focus()}else{$("#askpassword").hide();editor.setValue(decrypt(hash.substring(1),$("#data").val()))}},error:function(){alert("bad password!")}})}function submitData(){if($("#text").val()==""){return false}if(_encrypting!=null){clearTimeout(_encrypting);_encrypting=null;$("#result").val("")}if($("#result").val()==""){$("#result").val(encrypt($("#key").val(),$("#text").val()))}$("#en").unbind("mouseenter mouseleave");$("#result").show();$("#encrypttime").show();var data=$("#result").val();data=encodeURIComponent(data);var password="";if($("#usepassword").is(":checked")){password=window.ezcrypt_backend.sha($("#typepassword").val())}var ttl=$("#ttl option:selected").val();var syntax=$("#syntax option:selected").val();if(typeof syntax=="undefined"){syntax=$("#syntax").val()}$.ajax({url:document.baseURI,type:"POST",dataType:"json",data:"&data="+data+"&p="+password+"&ttl="+ttl+"&syn="+syntax,cache:false,success:function(json){if(ttl==-100){}else{var querypw="";if(password!="")querypw="?p="+password;window.location=document.baseURI+"p/"+json.id+querypw+"#"+$("#key").val()}},error:function(){enableHover();alert("error submitting form")}})}if(document.getElementById("content")){window.editor=editor=CodeMirror.fromTextArea(document.getElementById("content"),{lineNumbers:true,matchBrackets:false,lineWrapping:false,readOnly:true,onChange:onCodeChange});editor.setOption("mode",$("#syntax").val());editor.focus()}window.ezcrypt_backend.randomKey(function(key){$("#key").val(key);var en=$("#en");en.bind("click",submitData);en.removeAttr("disabled");en.val("Submit");$("#text").bind("textchange",function(){if(_encrypting!=null){clearTimeout(_encrypting);_encrypting=null}_encrypting=setTimeout(function(){$("#result").val(encrypt($("#key").val(),$("#text").val()));_encrypting=null},500)})});$("#text").live("keydown",function(e){if(e.keyCode==13&&e.ctrlKey){$("#en").click()}});$("#usepassword").change(function(){if(this.checked){$("#typepassword").show()}else{$("#typepassword").hide()}});$("#submitpassword").bind("click",requestData);$("#new").bind("click",function(){$("#text").html("");$("#result").val("");$("#newpaste").slideDown()});$("#clone").bind("click",function(){$("#text").html(editor.getValue()).trigger("textchange");$("#newpaste").slideDown()});$("#tool-wrap").bind("click",function(){var checked=$("#tool-wrap").is(":checked");if(checked==1){$(".tool-wrap").addClass("tool-wrap-on");editor.setOption("lineWrapping",true)}else{$(".tool-wrap").removeClass("tool-wrap-on");editor.setOption("lineWrapping",false)}});$("#tool-numbers").bind("click",function(){var checked=$("#tool-numbers").is(":checked");if(checked==1){$(".tool-numbers").addClass("tool-numbers-on");editor.setOption("lineNumbers",true)}else{$(".tool-numbers").removeClass("tool-numbers-on");editor.setOption("lineNumbers",false)}});$("#tool-fullscreen").bind("click",function(){var checked=$("#tool-fullscreen").is(":checked");if(checked==1){$(".tool-fullscreen").addClass("tool-fullscreen-on");$("#holder").css("width","100%")}else{$(".tool-fullscreen").removeClass("tool-fullscreen-on");$("#holder").css("width","")}});enableHover();window.ezcrypt={sha:window.ezcrypt_backend.sha,encrypt:encrypt,decrypt:decrypt,editor:editor,requestData:requestData}});
//# sourceMappingURL=core-0.4-1.min.js.map